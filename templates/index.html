<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>EPUB Speedread</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Manrope:wght@300;400;600;700&family=Yeseva+One&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <div class="hero__badge">Лисий ритуал чтения</div>
        <h1>EPUB для скорочтения</h1>
        <p>Загрузи EPUB — на выходе получишь EPUB с выделением слогов или Bionic Reading, с красными строками и отбивкой абзацев.</p>
      </header>

      <section class="panel">
        <div class="panel__header">
          <h2>Конвертация</h2>
          <div class="fox-row" aria-hidden="true">
            <span class="fox">◆</span><span class="fox">◆</span><span class="fox">◆</span>
          </div>
        </div>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="flash">
              {% for message in messages %}
                <div>{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <form class="card form" action="/convert" method="post" enctype="multipart/form-data">
          <label class="field">
            <span>EPUB-файл</span>
            <input type="file" name="epub" accept=".epub" required />
          </label>
          <label class="field">
            <span>Режим выделения</span>
            <select name="mode">
              <option value="syllable">Слоги (полужирные первые слоги)</option>
              <option value="bionic">Bionic Reading (пропорционально длине)</option>
            </select>
          </label>
          <label class="check">
            <input type="checkbox" name="dim_punct" />
            <span>Приглушать пунктуацию</span>
          </label>
          <label class="check">
            <input type="checkbox" name="blank_lines" />
            <span>Пустые строки между абзацами</span>
          </label>
          <button class="btn primary" type="submit">Конвертировать</button>
        </form>

        <div class="warning">
          Важно: при включённых флажках «Приглушать пунктуацию» и «Пустые строки между абзацами»
          возможна ошибка <strong>Internal Server Error</strong> из-за превышения лимита памяти на
          бесплатном хостинге. Рекомендуется использовать эти опции только для очень маленьких книг.
        </div>

        <p class="note">
          Обработка затрагивает только текст в &lt;body&gt;, изображения и оглавление сохраняются.
        </p>
      </section>
      <footer class="credits">
        <div class="credits__label">Авторство</div>
        <div class="credits__text">
          Идея и постановка — Братец Лис. Код — ассистент Codex.
        </div>
        <a class="credits__link" href="https://t.me/brfox_cosplay" target="_blank" rel="noopener noreferrer">
          t.me/brfox_cosplay
        </a>
      </footer>
    </div>
  </body>
</html>
